<div class="row">
  <div class="col-md-2 col-md-offset-1">
    <center>
      <div class='profile_pic'><%= image_tag(current_user.image) %></div>
      <h1><%= current_user.name %></h1>
      <%= link_to 'Log Out', logout_path %>
      <br>
      <br>
      <%= link_to 'See local photos!', local_path %>
      <br>
      <br>
      Search for photos by tag:
      <br>
      <br>
      <%= form_tag('/welcome') %>
      <%= text_field_tag :searchterm %>
      <br>
      <br>
      <%= submit_tag "Search"%>
    </center>
  </div>

  <div class="col-md-9 effects clearfix" id="slide-up">

    <% @viewdata["data"].each do |val| %>
    <div class='img'>
      <img src="<%= val['images']['low_resolution']['url'] %>">
    <div class='overlay'><a href='#' class='expand'><h5><%= val['caption']['text'] %><%= link_to 'Favorite This', photos_path, class: 'btn btn-success' %></h5></a><a class='close-overlay hidden'>x</a></div>    </div>

    <% end %>

  </div>
</div>

<script type="text/javascript">
$(function(){
  $(".img").mouseenter(function(){
      $(this).addClass("hover");
      $('.btn').on('click', function(){
        var closestImg = $(this).closest('.img');
        var photoUrl = closestImg.children().attr('src');
        $.ajax({
          url: '/photos',
          type: 'POST',
          data: JSON.stringify({url: photoUrl}),
          contentType: 'application/json',
          dataType: 'json'
        });
      });
  })
  // handle the mouseleave functionality
  .mouseleave(function(){
      $(this).removeClass("hover");
  });
});

</script>
